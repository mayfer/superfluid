<!doctype html>
<html>
    <head>
        <link rel="shortcut icon" type="image/png" href="favicon.png"/>
        <meta charset="utf-8" />
        <title>Swim Team &bull; V</title>
        <meta property="og:image" content="/assets/cover.png">
        <meta property="og:image:type" content="image/png">
        <meta property="og:image:width" content="1400">
        <meta property="og:image:height" content="1400">
        <script src="libs/howler.core.min.js"></script>
        <script src='libs/require-2.3.5.min.js'></script>
        <script src='libs/jquery-1.11.1.min.js'></script>
        <script src="libs/canvas.js"></script>
        <link href="https://fonts.googleapis.com/css?family=Major+Mono+Display" rel="stylesheet">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <style>
            * { margin: 0; padding: 0; }
            html, body {
                width: 100%;
                height: 100%;
                background: #fff;
                font-family: monospace;
            }

            #wrapper {
                position: relative;
                height: 100%;

                background: white;
            }

            #square {
                position: relative;
                height: 100%;
                width: 100%;
            }
            #main {
                position: absolute; top: 50px; bottom: 50px; left: 50px; right: 50px;
            }
            #frame {
                display: block;
                height: 100%; width: 100%;
            }

            .dots { background: #000; }
            img { display: block; }
            .swimteam { width: 7%; position: absolute; top: 7%; left: 7%; }
            .v { width: 10%; position: absolute; right: 5%; bottom: 5%; }


            #tracks { display: none; font-size: 17px; font-family: 'Major Mono Display', monospace;   }
            #tracks ol { margin: 0 70px; padding: 0; font-weight: bold;  }
            #tracks.bottom { display: block; position: relative; margin: 0 10%; padding-bottom: 100px; }


            #tracks.right {
                position: absolute; top: 0; left: 50%; right: 0; height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            #tracks .track { position: relative; cursor: pointer; margin: 20px 0; padding: 0; border-bottom: 1px solid #ddd; min-width: 220px; }
            #tracks .track:hover { border-bottom: 1px solid #000; }
            #tracks .duration { color: #aaa; float: right; font-size: 10px; }
            #tracks .track.loading:after { content: " loading..."; position: absolute; bottom: -13px; left: 0px; font-size: 11px; color: #a00; }
            #tracks .track.playing { font-weight: bold; border-bottom: 1px solid #a00; background-shadow: 0 0 3px 0 red; }
            #tracks .track.playing:before { content: "‖"; width: 30px; height: 30px; text-align: center; position: absolute; left: -80px; top: -1px; }
            #tracks .track.paused:before { content: "▶"; width: 30px; height: 30px; text-align: center; position: absolute; left: -80px; top: -1px; }

            @media screen and (max-width: 600px){
                #main {
                    top: 20px; bottom: 20px; left: 20px; right: 20px;
                }
                #tracks .track { min-width: 160px; }
            }

            #tracks .more {  margin-top: 30px; line-height: 30px; }
            #tracks .more a { display: block; color: #ccc; text-decoration: none; }
            #tracks .icon { display: inline-block; width: 52.5px; text-align: right; margin-right: 4px; letter-spacing: 2px; }
            #tracks .download { }
            #tracks .download:hover { color: #0a0; cursor: pointer; }
            #tracks .info:hover { color: #00a; cursor: pointer; }
            #tracks .contact:hover { color: #950; cursor: pointer; }

            #info {
                display: none;
                font-family: sans-serif;
                color: #333;
                position: fixed;
                background: rgba(0, 0, 0, 0.1);
                top: 0; left: 0; height: 100%; width: 100%;
            }
            #info:target {
                display: flex;
                align-items: center;
                justify-content: center;
            }
            #info .inner {
                padding: 50px;
                border-radius: 10px;
                background: #fff;
                width: 300px;
            }
            #info .inner p {
                margin: 0 0 15px 0;
            }
            #info a {
                font-weight: bold;
                display: block;
                text-align: center;
                    color: #000;
            }

        </style>
    </head>
    <body>
        </div>
        <div id="wrapper">
            <div id="square">
                <div id="main">
                    <div id="frame"></div>
                    <img class='swimteam' src='./assets/swimteam.svg?' />
                    <img class='v' src='./assets/v.svg?' />
                </div>
            </div>
            <div id="tracks">
                <div class='inner'>
                    <ol></ol>
                    <div class='more'>
                        <a class='download' href='https://s3.amazonaws.com/swim-team/Swim+Team+-+V.zip'>
                            <span class='icon'>&#8681;.</span> download
                        </a>
                        <a class='info' href='#info'>
                            <span class='icon'>ⓘ.</span> info
                        </a>
                        <a class='contact' href='mailto:swim.team.van@gmail.com'>
                            <span class='icon'>&#9742;.</span> contact
                        </a>
                    </div>
                </div>
            </div>
            <div id='info'>
                <div class='inner'>

                    <div>
                        <p>Swim Team is a rock trio from Vancouver, BC consisting of members Dorothy Neufeld, Murat Ayfer, and Nick Short.</p>
                        <p>V is the third release, self-recorded and produced from sept 2018-oct 2019.</p>
                        <p>Mastered by Jordan Koop.</p>
                    </div>
                    <a href='#'>close</a>
                </div>
            </div>
        </div>
        <script>

            var extend = function(dest, from) {
                var props = Object.getOwnPropertyNames(from);
                props.forEach(function(name) {
                    if (name in dest) {
                        var destination = Object.getOwnPropertyDescriptor(from, name);
                        Object.defineProperty(dest, name, destination);
                    }
                });
                return dest;
            };

            function loadapp(name) {
                var file = "" + name + ".js";
                requirejs([file], function(lib) {
                    app = new lib($('#frame').get(0));
                });
            }

            $(document).ready(function(){
                window.app = null;

                var maxlenpx = Math.min($('#square').innerHeight(), $('#square').innerWidth());
                $('#square').css('width', parseInt(maxlenpx)+"px");
                $('#square').css('height', parseInt(maxlenpx)+"px");

                window.app = loadapp('circles');


                $('#nav a').on('click', function(e){
                    e.preventDefault();
                    var name = $(this).attr('name');
                    loadapp(name);
                });
            });
        </script>
        
        <script>
            $(document).ready(function () {

                var resize = function() {
                    if (window.app) window.app.resize();
                    if($(document).height() - $(document).width() < -300) {
                        $('#tracks').removeClass('bottom');
                        $('#tracks').addClass('right');
                    } else {
                        $('#tracks').addClass('bottom');
                        $('#tracks').removeClass('right');
                    }
                }
                resize();
                
                window.addEventListener('resize', function(e){
                    resize()
                });

                var tracks = [
                    {title: 'Brick', id: 'brick', files: [
                        //'https://s3.amazonaws.com/swim-team/01+-+Brick.m4a',
                        'https://s3.amazonaws.com/swim-team/01+-+Brick.mp3',
                    ], duration: '3:18'},
                    {title: 'X', id: 'x', files: [
                        //'https://s3.amazonaws.com/swim-team/02+-+X.m4a',
                        'https://s3.amazonaws.com/swim-team/02+-+X.mp3',
                    ], duration: '2:58'},
                    {title: 'Garden', id: 'garden', files: [
                        //'https://s3.amazonaws.com/swim-team/03+-+Garden.m4a',
                        'https://s3.amazonaws.com/swim-team/03+-+Garden.mp3',
                    ], duration: '3:20'},
                    {title: 'Empire', id: 'empire', files: [
                        //'https://s3.amazonaws.com/swim-team/04+-+Empire.m4a',
                        'https://s3.amazonaws.com/swim-team/04+-+Empire.mp3',
                    ], duration: '2:50'},
                    {title: 'Rabbit', id: 'rabbit', files: [
                        //'https://s3.amazonaws.com/swim-team/05+-+Rabbit.m4a',
                        'https://s3.amazonaws.com/swim-team/05+-+Rabbit.mp3',
                    ], duration: '2:57'},
                    {title: 'Mango', id: 'mango', files: [
                        //'https://s3.amazonaws.com/swim-team/06+-+Mango.m4a',
                        'https://s3.amazonaws.com/swim-team/06+-+Mango.mp3',
                    ], duration: '2:41'},
                    {title: 'Firefly', id: 'firefly', files: [
                        //'https://s3.amazonaws.com/swim-team/07+-+Firefly.m4a',
                        'https://s3.amazonaws.com/swim-team/07+-+Firefly.mp3',
                    ], duration: '3:11'},
                    {title: 'Cardinal', id: 'cardinal', files: [
                        //'https://s3.amazonaws.com/swim-team/08+-+Cardinal.m4a',
                        'https://s3.amazonaws.com/swim-team/08+-+Cardinal.mp3',
                    ], duration: '3:06'},
                    {title: 'V', id: 'v', files: [
                        //'https://s3.amazonaws.com/swim-team/09+-+V.m4a',
                        'https://s3.amazonaws.com/swim-team/09+-+V.mp3',
                    ], duration: '5:03'},
                    {title: 'Tendency', id: 'tendency', files: [
                        //'https://s3.amazonaws.com/swim-team/10+-+Tendency.m4a',
                        'https://s3.amazonaws.com/swim-team/10+-+Tendency.mp3',
                    ], duration: '3:10'},
                ];

                var sounds = {};
                
                tracks.forEach(function(track, index){
                    var sound = new Howl({
                      src: track.files,
                      preload: false,
                      html5: true,
                    });

                    sound.identifier = track.id;
                    sound.on('load', function(){
                        var elem = $('#'+this.identifier)
                        elem.removeClass('loading');
                    });
                    sound.on('play', function(){
                        var elem = $('#'+this.identifier)
                        elem.removeClass('loading');
                        elem.removeClass('paused');
                        elem.addClass('playing');
                    });
                    sound.on('stop', function(){
                        var elem = $('#'+this.identifier)
                        elem.removeClass('playing');
                        elem.removeClass('loading');
                        elem.removeClass('paused');
                    });
                    sound.on('pause', function(){
                        var elem = $('#'+this.identifier)
                        elem.removeClass('playing');
                        elem.removeClass('loading');
                        elem.addClass('paused');
                    });
                    sound.on('end', function(){
                        var elem = $('#'+this.identifier)
                        this.stop();
                        var next = elem.next('.track');
                        if(next.length) next.click();
                    });

                    sounds[track.id] = sound;

                    var trackdiv = $("<li class='track' id='"+track.id+"'>"+track.title+" <span class='duration'>"+track.duration+"</span></li>")
                    $('#tracks ol').append(trackdiv);
                });


                var stop_all = function() {
                    for(var trackid in sounds) {
                        sounds[trackid].stop();
                    }
                }

                $('#tracks').on('click', '.track', function(e){
                    var trackid = $(this).attr('id');
                    var elem = $(this);
                    var sound = sounds[trackid];

                    if(sound.playing()) {
                        sound.pause();
                    } else if($(this).hasClass('paused')) {
                        sound.play();
                    } else {
                        stop_all();
                        sound.play();
                        window.playing_track = sound;

                        if(sound.state() != 'loaded') {
                            elem.addClass('loading');
                        }
                    }
                });

                $('body').keyup(function(e){
                    if(e.keyCode == 32){
                        // user has pressed space
                        if(window.playing_track) {
                            if(window.playing_track.playing()) {
                                window.playing_track.pause();
                            } else {
                                window.playing_track.play();
                            }
                        }
                    }
                });
            });
        </script>
        
    </body>
</html>
